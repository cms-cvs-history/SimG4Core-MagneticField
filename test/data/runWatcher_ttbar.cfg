process PROD  = 
{

   service = MessageLogger
   {
      untracked vstring destinations = {"cout"}      
      untracked vstring categories = { "FieldStepWatcher" }             
      untracked PSet cout = 
      { 
         untracked PSet default = { untracked int32 limit = 0 }
	 untracked PSet FieldStepWatcher = { untracked int32 limit = -1 }
      }
   }
   
   service = Timing {}

   service = RandomNumberGeneratorService
   {
      untracked uint32 sourceSeed = 123456789
      PSet moduleSeeds =
      {
         untracked uint32 VtxSmeared = 12345
         untracked uint32 g4SimHits = 9876
      }
   }

   include "DQMServices/Core/data/DQM.cfg"
   replace DQM.collectorHost = ""
   
   ###include "SimGeneral/HepPDTESSource/data/pdt.cfi"
   include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"

   untracked PSet maxEvents = {untracked int32 input = 50}
   module randomEngineStateProducer = RandomEngineStateProducer { }

   source = PythiaSource {
     untracked int32 pythiaPylistVerbosity = 0
     untracked bool pythiaHepMCVerbosity = false
     untracked int32 maxEventsToPrint = 0
     untracked bool pythiaVerbosity = false

     PSet PythiaParameters = {
       # This is a vector of ParameterSet names to be read, in this order
       vstring parameterSets =  {
         "pythiaUESettings",
         "processParameters"
       }

       # CMS default pythia parameters
       include "Configuration/Generator/data/PythiaUESettings.cfi"

       vstring processParameters = {
         'MSEL=0                  ! User defined processes',
         'MSUB(81) = 1            ! qqbar to QQbar',
         'MSUB(82) = 1            ! gg to QQbar',
         'MSTP(7) = 6             ! flavour = top',
         'PMAS(6,1) = 175.        ! top quark mass'
       }
     }
   }
      
   include "IOMC/EventVertexGenerators/data/VtxSmearedGauss.cfi"

   #Geometry
   #   
   include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"
   include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

   # Magnetic Field
   #
   include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
   
   # Geant4-based CMS Det.Simulation
   #
   # the 'replace' option below show how to override the default
   # setting of mag.field key (tu turn it off)
   #
   include "SimG4Core/Application/data/g4SimHits.cfi"
   replace g4SimHits.Watchers = {
      {string type              = "FieldStepWatcher"
       untracked int32  DepthLevel = 3
       untracked string OutputFile = "fieldStudyTTBar.root"
      }
   }
   replace g4SimHits.MagneticField.UseLocalMagFieldManager = false
   replace g4SimHits.MagneticField.delta = 1.
   replace g4SimHits.MagneticField.Verbosity = false
		  
   path p1 = { VtxSmeared, g4SimHits }
   
}		
